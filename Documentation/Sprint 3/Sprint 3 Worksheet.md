# yAPP // Sprint 3 Worksheet

## Load Testing

## Security Analysis
1. Our group looked at a WIDE variety of tools to run our static code analysis, but due to time constraints we decided to stick to the built-in tools provided by the IDEs we currently use. We looked at extensions from VS Code or the built-in analyzer from Visual Studio, but it simply was not working on its own. We then turned to the next possible option suggested by the good old internet, using the Roslyn code analyzer that could be installed through NuGet (specifically Microsoft.CodeAnalysis.FxCopAnalyzers - the latest version) which is compatible with our main language, C#. Then, we simply rebuilt our project with this security-oriented package. By doing this, we were able to output more security-focused errors in the Error List in Visual Studio. The output of our analysis shows that we have no critical security risks or errors. However, it did helpfully show that we had over 1500 warnings with 100 suggestions... To make sure we weren't missing anything, we also ran ReSharper with our IDE Rider. It showed similar results and provided a complicated to understand xml file as output. We've attached the link to it in the appendices of this document along with a screenshot of the output from the first analysis.

2. Upon inspecting the multitude of warnings that appeared in our code analysis, there was definitely a certain pattern that could be found. However, we're just going to analyze five random warnings that appeared.
    - "Modify 'UpdateUser' to catch a more specific allowed exception type, or rethrow the exception": Upon double clicking on this issue, it outlines the [function in question](../../amplify/backend/function/yAppLambda/src/Common/CognitoActions.cs#47). We can see from the code that we wrote that there is definitely probably a better Exception that could have been thrown. Perhaps a good course of action could have been to create an entire custom Exceptions class such as the one we used in 3350 so that we are throwing and catching the right exceptions. Additionally, the exception message could potentially be more descriptive. 
    - "Do not use Assert.Equal() to check for collection size": Double clicking this error brings us to one of our [test files](../../amplify/backend/function/Tests/UnitTests/Controllers/PostControllerTests.cs#666). As the warning states, it says that we probably shouldn't be using the equal function to test for the length of the list being returned. Perhaps we should be looking into using a more specific Assert function as opposed to just equal. But as this is one of the test files, I am sure that it's fine if we have some vulnerabilities such as these.
    - "Consider calling ConfigureAwait on the awaited task": [This file](../../amplify/backend/function/yAppLambda/src/DynamoDB/VoteActions.cs#235) is where this warning is referring to. It would appear as though it is suggesting that we should be using a more robust function to await for the results as opposed to simply using the `await` function. Perhaps this could fix some of the flaky tests that we were getting with differing network/device speeds when running tests?
    - "Remove the underscores from member name Tests.UnitTests.Controllers.PostControllerTests.GetRecentPosts_ShouldReturnBadRequest_WithInvalidRequest()". There are quite a lot of warnings for our test files, where it is mostly complaining about how we've named our tests, like in [this file](../../amplify/backend/function/Tests/UnitTests/Controllers/PostControllerTests.cs#441). This issue certainly seems more like a coding standards warning and could probably be suppressed and ignored as it does not pose any sort of security threat to our system.
    - "Count() is used where Any() could be used instead to improve performance". While this is more of a performance issue, it is still a helpful warning. If our endpoints are slow, it could leave us vulnerable to attacks from outsiders, so trying to maximize performance is pretty important, and something we strove to do in our algorithm designs. However, it would seem that there are always ways to improve, as shown [here](../../amplify/backend/function/yAppLambda/src/DynamoDB/AwardActions.cs#290).

3. As our project did not produce any errors, we have no critical problems to solve. No commits for fixing code will need to be made, and we will instead be discussing two of the more common warnings that appeared in the analysis.
    - "'IDynamoDBContext.DeleteAsync<T>(T, DynamoDBOperationConfig, CancellationToken)' is obsolete: 'Use the DeleteAsync overload that takes DeleteConfig instead, since DynamoDBOperationConfig contains properties that are not applicable to DeleteAsync.'": This warning in particular is one that has shown up in a lot of places throughout our code, particularly whenever we are performing database actions (not just Delete). [This example](../../amplify/backend/function/yAppLambda/src/DynamoDB/CommentActions.cs#175) specifically shows that our usage of the dynamodb functions may not be the most appropriate. However, a big part of this is due to the lack of documentation that DynamoDB has, and it has been working for our application. But this does potentially leave an opening for weird properties being passed into our database, maybe causing catastrophic errors.
    - "The behavior of 'DateTime.ToString(string)' could vary based on the current user's locale settings. Replace this call in 'PostActions.GetRecentPosts(DateTime, int)' with a call to 'DateTime.ToString(string, IFormatProvider)'". We've had many issues surrounding datetime, and this warning suggests that [this usage](../../amplify/backend/function/yAppLambda/src/DynamoDB/PostActions.cs#238) could potentially be the culprit/cause for all of our problems! This warning is helpful for outlining where our app may fail if it were to receive an invalid datetime format based on where the user is from. Knowing this, perhaps it may have helped with time spent debugging datetime formatting errors from the backend communicating to the frontend. 

## Continuous Integration and Deployment (CI/CD)

## Thoughts

## Other Thoughts


# Appendix for Security Analysis
Here is a screenshot of the output from building the project and viewing the error list window with code analysis turned on.
![Image output from Visual Studio](./Resources/StaticSecurityAnalysisOutput.png)

[Here is the report](./Resources/InspectionReport.xml) produced by the static analysis tool when running the security analysis tool on our source code.